<script type="text/javascript">
(function attQuickBtnsPlugin() {
  var dictTimeEntryRows  = {
    // TODO: Replace values with PS Localization Keys
    "in": "Clock In",
    "out": "Clock Out"
  };
  
  // using a cloneable template as changing the 'type' attribute of a button causes issues on IE
  var btnButtonTemplate = document.createRange().createContextualFragment('<button type="button" class="attQuickButton"></button>').firstElementChild;
  btnButtonTemplate.setAttribute('class','attqckbttns');
  btnButtonTemplate.setAttribute('style','margin-left:1em');
  
  function setInputToTime(whichInput, timeVal) {
    if (dictTimeEntryRows.hasOwnProperty(whichInput)) {
      if (timeVal === "now") {
        $j(`tr:contains(${dictTimeEntryRows[whichInput]}) input.timeEntry`).timeEntry('setTime', new Date());
      }
    }
  }

  var btnTimeIn_Current = btnButtonTemplate.cloneNode();
  btnTimeIn_Current.innerText = "Current Time";
  btnTimeIn_Current.onclick = function() {setInputToTime("in", "now")};
  
  var btnTimeOut_Current = btnButtonTemplate.cloneNode();
  btnTimeOut_Current.innerText = "Current Time";
  btnTimeOut_Current.onclick = function() {setInputToTime("out", "now")};

  var fragQckBtnsRow_In = document.createDocumentFragment();
  fragQckBtnsRow_In.appendChild(document.createElement("span"));
  fragQckBtnsRow_In.firstElementChild.setAttribute('class','qckbttns-row');
  fragQckBtnsRow_In.firstElementChild.appendChild(btnTimeIn_Current);

  var fragQckBtnsRow_Out = document.createDocumentFragment();
  fragQckBtnsRow_Out.appendChild(document.createElement("span"));
  fragQckBtnsRow_Out.firstElementChild.setAttribute('class','qckbttns-row');
  fragQckBtnsRow_Out.firstElementChild.appendChild(btnTimeOut_Current);

  $j( document ).ready(function() {
    $j(`tr:contains(${dictTimeEntryRows['in']}) td:has(input.timeEntry)`).contents().filter((_, el) => el.nodeType === 3).remove();
    $j(`tr:contains(${dictTimeEntryRows['out']}) td:has(input.timeEntry)`).contents().filter((_, el) => el.nodeType === 3).remove();
    $j(`tr:contains(${dictTimeEntryRows['in']}) td:has(input.timeEntry)`).contents().last().append(fragQckBtnsRow_In);
    $j(`tr:contains(${dictTimeEntryRows['out']}) td:has(input.timeEntry)`).contents().last().append(fragQckBtnsRow_Out);
  });
})();
</script>